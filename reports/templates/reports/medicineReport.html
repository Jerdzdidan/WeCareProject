{% extends "home/layout.html" %}
{% load static %}

{% block style %}
<style>
  .info-card {
    margin-bottom: 1.5rem;
  }
  table td, table th {
    text-align: center !important;
    vertical-align: middle;
  }
</style>
{% endblock style %}

{% block body %}
  <h3 class="mb-3">Medicine Record - <span class="text-primary">Inventory</span></h3>
    <article class="content-section border rounded p-0 mx-0 px-0 shadow">
        <div class="container">
            <div class="row mt-2">
              <div class="col-md-auto ms-sm-auto"> 
                  <div class="d-flex gap-2 mt-3 mt-sm-0"> 
                    <a class="btn btn btn-outline-primary btn-block px-4" href="{% url 'medicine-export-pdf' %}?{{ request.GET.urlencode }}">
                      <i class="ri-printer-line"></i> 
                    </a>
                  </div> 
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-auto">
                <select id="customEntries" class="form-select d-inline w-auto border-secondary fw-bold" style="font-size: calc(0.8rem + 0.2vw); cursor: pointer; vertical-align: middle;">
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
                <span class="d-inline ms-2" style="font-size: calc(0.8rem + 0.2vw); vertical-align: middle;">Entries per page</span>
              </div>
              <div class="col-auto ms-auto">
                  <div class="input-group input-group-merge"> 
                      <span class="input-group-text"><i class="ri-search-line"></i></span> 
                      <input type="text" id="searchBar" class="form-control" placeholder="Search" aria-label="Search"> 
                  </div> 
              </div>
            </div>
          </div>
        <div class="table-responsive w-100">
            <table id="dataTable" class="table table-light table-striped text-center m-0 w-100 projectTables">
                <thead class="table-dark">
                <tr>
                    <th>Medicine Name</th>
                    <th>Dosage</th>
                    <th>Generic Name</th>
                    <th>Brand Name</th>
                    <th>Unit Price</th>
                    <th>Total Value</th>
                    <th>Total Quantity</th>
                    <th>Released Quantity</th>
                    <th>Expired Quantity</th>
                    <th>Supplier</th>
                    <th>Date Last Stocked</th>
                    <th>Notes</th>
                </tr>
                </thead>
                <tbody>
                {% for med in medicines %}
                <tr>
                    <td class="align-middle">{{ med.medicine_name }}</td>
                    <td class="align-middle">{{ med.dosage }}</td>
                    <td class="align-middle">{{ med.generic_name }}</td>
                    <td class="align-middle">{{ med.brand_name }}</td>
                    <td class="align-middle">₱{{ med.unit_price|floatformat:2 }}</td>
                    <td class="align-middle">₱{{ med.total_value|floatformat:2 }}</td>
                    <td class="align-middle">{{ med.total_quantity }}</td>
                    <td class="align-middle">{{ med.releasedQty|default:"0" }}</td>
                    <td class="align-middle">{{ med.expiredQty|default:"0" }}</td>
                    <td class="align-middle">{{ med.supplier_name }}</td>
                    <td class="align-middle">{{ med.date_last_stock|date:"M. d, Y" }}</td>
                    <td class="align-middle">{{ med.notes }}</td>
                </tr>
                {% endfor %}
                </tbody>
            </table>
            <div id="customPagination"></div>
        </div>
  </article>
{% endblock body %}

{% block script %}
<script>
$('#myModal').on('show.bs.modal', function(event) {
    var button = $(event.relatedTarget);
    var deleteData = button.attr('data-deleteData');
    var dataID = button.attr('data-ID')
    var txtDeleteData = deleteData;
    $(this).find('#deleteMessage').text('Are you sure you want to delete the Medicine Record for: ');
    $(this).find('#txtDeleteData').text(txtDeleteData);
    $(this).find('#btnDelete').attr('href', '{% url "medicine-delete" 0 %}'.replace('0', dataID));
});
</script>
{% endblock script %}
