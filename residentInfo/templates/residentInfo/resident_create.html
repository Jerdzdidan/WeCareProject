{% extends "home/layout.html" %}
{% load crispy_forms_tags %}

{% comment %} Insert Custom Page Style Here
{% block style %}

{% endblock style %} {% endcomment %}

{% comment %} Page Body {% endcomment %}
{% block body %}

    <article class="content-section border rounded p-3 shadow-sm">
        <h1>Register Your Family</h1>
        <form method="POST" action="{% url 'register_family' %}">
          {% csrf_token %}
          <h2>Family Head Information</h2>
          <label for="head_last_name">Last Name:</label>
          <input type="text" id="head_last_name" name="head_last_name" required>
          <br>
      
          <label for="head_first_name">First Name:</label>
          <input type="text" id="head_first_name" name="head_first_name" required>
          <br>
      
          <label for="head_middle_name">Middle Name:</label>
          <input type="text" id="head_middle_name" name="head_middle_name">
          <br>
      
          <label for="head_birthdate">Birthdate:</label>
          <input type="date" id="head_birthdate" name="head_birthdate" required>
          <br>
      
          <label for="head_age">Age:</label>
          <input type="number" id="head_age" name="head_age" required>
          <br>
      
          <label for="head_gender">Gender:</label>
          <select id="head_gender" name="head_gender" required>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
          </select>
          <br>
      
          <label for="head_civil_status">Civil Status:</label>
          <input type="text" id="head_civil_status" name="head_civil_status" required>
          <br>
      
          <label for="head_category">Category:</label>
          <select id="head_category" name="head_category">
            <option value="NA">N/A</option>
            <option value="Senior">Senior</option>
            <option value="Solo Parent">Solo Parent</option>
            <option value="Pregnant">Pregnant</option>
            <option value="Children">Children</option>
          </select>
          <br>
      
          <label for="head_present_address">Present Address:</label>
          <input type="text" id="head_present_address" name="head_present_address" required>
          <br>
      
          <label for="head_contact_number">Contact Number:</label>
          <input type="text" id="head_contact_number" name="head_contact_number" required>
          <br>
      
          <h2>Family Members Information</h2>
          <table id="familyMembersTable" border="1">
            <thead>
              <tr>
                <th>Last Name</th>
                <th>First Name</th>
                <th>Middle Name</th>
                <th>Relationship to Head</th>
                <th>Birthdate</th>
                <th>Age</th>
                <th>Civil Status</th>
                <th>Gender</th>
                <th>Category</th>
                <th>Present Address</th>
                <th>Contact Number</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <!-- New rows will be added here -->
            </tbody>
          </table>
          <button type="button" onclick="addFamilyMemberRow()">Add Family Member</button>
          <br><br>
          <input type="submit" value="Submit">
        </form>
    </article>

{% endblock %}


{% comment %} Insert Custom Page Script Here {% endcomment %}
{% block script %}
<script>
    function addFamilyMemberRow() {
      const tbody = document.getElementById('familyMembersTable').getElementsByTagName('tbody')[0];
      const rowCount = tbody.rows.length;
      const row = tbody.insertRow(rowCount);
      
      row.innerHTML = `
        <td><input type="text" name="members[${rowCount}][last_name]" required></td>
        <td><input type="text" name="members[${rowCount}][first_name]" required></td>
        <td><input type="text" name="members[${rowCount}][middle_name]"></td>
        <td><input type="text" name="members[${rowCount}][relationship]" required></td>
        <td><input type="date" name="members[${rowCount}][birthdate]" required></td>
        <td><input type="number" name="members[${rowCount}][age]" required></td>
        <td><input type="text" name="members[${rowCount}][civil_status]" required></td>
        <td>
          <select name="members[${rowCount}][gender]">
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
          </select>
        </td>
        <td>
          <select name="members[${rowCount}][category]">
            <option value="NA">N/A</option>
            <option value="Senior">Senior</option>
            <option value="Children">Children</option>
            <option value="Solo Parent">Solo Parent</option>
            <option value="Pregnant">Pregnant</option>
          </select>
        </td>
        <td><input type="text" name="members[${rowCount}][present_address]" required></td>
        <td><input type="text" name="members[${rowCount}][contact_number]" required></td>
        <td><button type="button" onclick="deleteFamilyMemberRow(this)">Delete</button></td>
      `;
    }

    function deleteFamilyMemberRow(btn) {
      const row = btn.parentNode.parentNode;
      row.parentNode.removeChild(row);
    }
  </script>
{% endblock script %} 